import pymongo
import certifi

def get_db_connection():
    # 1. Your connection string
    uri = "mongodb+srv://sakshipatil062007_db_user:Mongo_sakshi@cluster0.vepqdnh.mongodb.net/?appName=Cluster0"
    
    # 2. Connect to Atlas
    client = pymongo.MongoClient(uri, tlsCAFile=certifi.where())
    db = client['SnookerAnalytics']
    collection = db['live_ball_data']
    
    # 3. Create the TTL Index (The "Janitor" logic)
    # This only needs to run once, but running it every time is fine 
    # as MongoDB will ignore it if it already exists.
    #as we dont need that coordinates after 1 hour hence we set ttl so that storage is not wasted
    #and documents automatically got deleted after one hour
    collection.create_index("createdAt", expireAfterSeconds=3600)#This line is from MongoDB, and it creates a special type of index called a TTL (Time-To-Live) index.
    
    return collection
